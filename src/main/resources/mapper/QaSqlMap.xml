<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mabatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.bnksys.sangsang.mapper.QaMapper">


    <select id="selectDataDupYn" resultType="String">

        SELECT case when COUNT(*)=0 then 'N' ELSE 'Y' END AS DUP_YN
        FROM TB_스무고개결과
        WHERE email=#{email}

    </select>

    <delete id="deleteResultData" parameterType="HashMap">
        DELETE FROM TB_스무고개결과
        WHERE email=#{email}

    </delete>

    <select id="selectResultData" parameterType="HashMap" resultType="HashMap">

        SELECT CAST(공감사회기술 AS SIGNED)      AS 공감사회기술
             ,CAST(성실성 AS SIGNED)            AS 성실성
             ,CAST(개방성 AS SIGNED)            AS 개방성
             ,CAST(외향성 AS SIGNED)            AS 외향성
             ,CAST(우호성 AS SIGNED)            AS 우호성
             ,CAST(정서안정성 AS SIGNED)        AS 정서안정성
             ,CAST(기술전문성 AS SIGNED)        AS 기술전문성
             ,CAST(인지문제해결 AS SIGNED)      AS 인지문제해결
             ,CAST(대인영향력 AS SIGNED)        AS 대인영향력
             ,CAST(자기관리 AS SIGNED)          AS 자기관리
             ,CAST(적응력 AS SIGNED)            AS 적응력
             ,CAST(학습속도 AS SIGNED)          AS 학습속도
             ,CAST(대인민첩성 AS SIGNED)        AS 대인민첩성
             ,CAST(성과민첩성 AS SIGNED)        AS 성과민첩성
             ,CAST(자기인식 AS SIGNED)          AS 자기인식
             ,CAST(자기조절 AS SIGNED)          AS 자기조절

        FROM TB_스무고개결과
        WHERE email=#{email}

    </select>

    <select id="selectCommentResult" parameterType="HashMap" resultType="String">
            SELECT AI조언
            FROM TB_스무고개결과
            WHERE email=#{email}


    </select>


    <insert id="insertResultData" parameterType="HashMap">
        INSERT INTO TB_스무고개결과(

                               email
                             ,공감사회기술
                             ,성실성
                             ,개방성
                             ,외향성
                             ,우호성
                             ,정서안정성
                             ,기술전문성
                             ,인지문제해결
                             ,대인영향력
                             ,자기관리
                             ,적응력
                             ,학습속도
                             ,대인민첩성
                             ,성과민첩성
                             ,자기인식
                             ,자기조절
                             ,AI조언
                             ,완료일시
        )

        VALUES(
                #{email}
              ,IFNULL(#{공감사회기술},1)
              ,IFNULL(#{성실성},1)
              ,IFNULL(#{개방성},1)
              ,IFNULL(#{외향성},1)
              ,IFNULL(#{우호성},1)
              ,IFNULL(#{정서안정성},1)
              ,IFNULL(#{기술전문성},1)
              ,IFNULL(#{인지문제해결},1)
              ,IFNULL(#{대인영향력},1)
              ,IFNULL(#{자기관리},1)
              ,IFNULL(#{적응력},1)
              ,IFNULL(#{학습속도},1)
              ,IFNULL(#{대인민첩성},1)
              ,IFNULL(#{성과민첩성},1)
              ,IFNULL(#{자기인식},1)
              ,IFNULL(#{자기조절},1)
              ,#{AI조언}
              ,NOW()

              )

    </insert>



    <select id="selectRecommendDetail" parameterType="String" resultType="Hashmap">
        SELECT 기관명
             ,  공고명
             ,  CONCAT(공고시작일,' ~ ',공고마감일) AS 접수기간
             ,  공고시작일
             , 공고마감일


        FROM TMP_채용공고_분리 a
        WHERE id=#{value}

    </select>




</mapper>


